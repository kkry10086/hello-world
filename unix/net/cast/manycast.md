## 一、多播

数据的收发仅仅在同一分组中进行


## 二、特点
1. 多播地址标示一组接口
2. 多播可以用来广域网使用
3. 在IPv4中，多播是可选的

## 三、多播的地址

多播组的ip：224.0.0.1 ~ 239.255.255.255

假设其多播ip地址是 224.0.0.1 
那mac地址是：

|01|00|5e|0|...|
|:-:|:-:|:-:|:-:|
|8bits|8bits|8bits|1bits|23bits，等于ip的最后23位地址|

则mac是：01:00:5e:00:00:01

## 四、加入多播的变化

通过函数加入多播地址：224.0.0.1

| 应用层                                                                               |
|:------------------------------------------------------------------------------------:|
| 运输层  打开相应的port                                                                |
| 网络层：增加备用ip：224.0.0.1，现在的ip：10.60.98.17，255.255.255.255，10.60.255.255   |
| 数据链路层 ：增加备用mac:01:00:5e:00:00:01 ， 现在的mac： 01:01:03:0b:dc:ef            |
## 五、注意

<strong><font color="red">这里的数据链路层的过滤是不完备的，因为不同的多播ip地址，可以生成同一个mac地址。
假设224.0.0.1 和 224.128.0.1 由于只拿最后23位置，第24位无论是什么都会变成0，所以当最后24位中只有第24位不同时，生成的mac是相同的。</font></strong>


## 六、函数：

**结构体：**
struct ip_mreq{
  struct in_addr imr_multiaddr;//多播组ip
  struct in_addr imr_interface;//将要添加到多播组的ip
}

**函数**
setsockopt()

|level|optname|说明|optval类型|
|:-:|:-:|:-:|:-:|
|IPPROTO_IP|ip_ADD_MEMBERSHIP|加入多播组|ip_mreq{}|
|IPPROTO_IP|ip_DROP_MEMBERSHIP|离开多播组|ip_mreq{}|



