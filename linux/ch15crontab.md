                    第十五章、例行性工作排程（crontab）


15.1 什么是例行性工作排程


  15.1.1 linux 工作排程的种类：at,cron
    1.一种是例行性的，就是每隔一定的周期要来办的事项
    2.一种是突发性的，就是这次做完以后就没有的那一种

　　at:at是个可以处理仅执行一次就结束排程的指令，不过要执行at时，必须要有atd这个服务
　　　　的支援才行．在某些新版的distributions中，atd可能预设并没有启动，那么at这个
　　　　指令就会失效．
　　
    crontab:crontab这个指令所设定的工作将会循环的一直进行下去．可循环的时间为分钟，
    　　　　小时，每周，每月，每年等．crontab除了可以使用指令执行外，亦可编辑
           /etc/crontab来支持．至于让crontab可以生效的服务则是crond这个服务．


  15.1.2 CentOS Linux系统上常见的例行性工作
  　1.进行登陆档的轮替（log rotate）:
      linux 会主动的将系统所发生的各种信息都记录下来．由于系统会一直记录登陆信息，所以
      登陆文件将会越来越大．我们知道大型文件不但占容量还会造成读写效能的困扰，因此适时
      的将登陆文件数据挪一挪，让旧的数据与新的数据分别存放，则比较可以有效的记录登陆信
      息．


    2.登陆文件分析logwatch的任务：
    　如果系统发生了软件问题，硬件错误，资安问题等，绝大部分的错误信息都会被记录到登陆
    　文件中，因此系统管理员的重要任务之一就是分析登陆档．但你不可能手动透过vim等软件
    　区检视登陆文件，因为数据太复杂了．我们的Centos提供了一个程序[logwatch]来主动分析
    　登陆信息，所以你会发现，你的root老是会受到标题为logwatch的新建，那是正常的．
    
    3.建立locate的是数据库：
      locate指令是透过已经存在的文件名数据库来进行系统上文件名的查询．我们的文件名数据
      库是放置到/var/lib/mlocate/中．问题是，这个数据库怎么会主动更新？这就是系统的
      例行性工作所产生的效果，系统会主动的进行updatedb.
      
    4.man page　查询数据库的建立：
      与locate数据库类似的，可提供快速查询的man page db　也是个数据库，但如果要使用
      man page　数据库时，就得哟呵执行mandb才能够建立好．而这个man page数据库也是透
      过系统的例行性工作排程来自动执行的．
      
    5.RPM　软件登陆文件的建立：
      RPM是一种软件管理的机制．由于系统可能会常常变更软件，包括软件的新安装，非经常性
      更新等，都会造成软件文件名的差异．为了方便未来追踪，系统也帮我们将文件名做个排序
      的记录．有时候系统也会透过排程来帮满RPM数据库的重新建置．
      
    6.移除暂存档：
      某些软件在运作中会产生一些暂存档，但是当这个软件关闭时，这些暂存盘可能并不会主动
      的被移除．有些暂存盘则有时间性，如果超过一段时间后，这个暂存盘就没有效用了，此时
      移除这些暂存盘就是一件重要的工作．否则磁盘容量会被耗光．系统透过例行性工作排程执
      行名为tmpwatch的指令来上出这些暂存档．
      
    7.与网路服务有关的分析行为
      如果你有安装类似WWW服务器软件(一个名为apache的软件),那么你的Linux系统通常就会主
      动的分析该软件的登陆文件.同时某些凭证与认证的网络信息是否过期的问题.


15.2 仅执行一次的工作排程:

  15.2.1 atd 的启动与 at 运作的方式:
    要使用单一工作排程时,我们的linux系统上面必须要有负责这个排程的服务:atd.